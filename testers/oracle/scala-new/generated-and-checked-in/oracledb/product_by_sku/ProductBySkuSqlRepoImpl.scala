/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package oracledb.product_by_sku

import dev.typr.foundations.OracleTypes
import dev.typr.foundations.scala.Fragment
import java.sql.Connection
import dev.typr.foundations.scala.Fragment.sql

class ProductBySkuSqlRepoImpl extends ProductBySkuSqlRepo {
  override def apply(sku: String)(using c: Connection): List[ProductBySkuSqlRow] = {
    sql"""-- Find product by SKU
    SELECT
        p.product_id,
        p.sku,
        p.name,
        p.price,
        p.tags
    FROM products p
    WHERE p.sku = ${Fragment.encode(OracleTypes.varchar2, sku)}
    """.query(ProductBySkuSqlRow.`_rowParser`.all()).runUnchecked(c)
  }
}