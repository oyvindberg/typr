/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package oracledb.employees_by_department;

import static dev.typr.foundations.Fragment.interpolate;

import dev.typr.foundations.Fragment;
import dev.typr.foundations.OracleTypes;
import java.sql.Connection;
import java.util.List;

public class EmployeesByDepartmentSqlRepoImpl implements EmployeesByDepartmentSqlRepo {
  @Override
  public List<EmployeesByDepartmentSqlRow> apply(String deptCode, String deptRegion, Connection c) {
    return interpolate(
            Fragment.lit(
                "-- Get employees in a department\n"
                    + "SELECT\n"
                    + "    e.emp_number,\n"
                    + "    e.emp_suffix,\n"
                    + "    e.emp_name,\n"
                    + "    e.salary,\n"
                    + "    e.hire_date,\n"
                    + "    d.dept_name,\n"
                    + "    d.budget\n"
                    + "FROM employees e\n"
                    + "INNER JOIN departments d ON e.dept_code = d.dept_code AND e.dept_region ="
                    + " d.dept_region\n"
                    + "WHERE e.dept_code = "),
            Fragment.encode(OracleTypes.varchar2, deptCode),
            Fragment.lit("\n  AND e.dept_region = "),
            Fragment.encode(OracleTypes.varchar2, deptRegion),
            Fragment.lit("\nORDER BY e.emp_name\n"))
        .query(EmployeesByDepartmentSqlRow._rowParser.all())
        .runUnchecked(c);
  }
}
