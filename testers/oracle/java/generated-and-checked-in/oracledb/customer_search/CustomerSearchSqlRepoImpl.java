/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package oracledb.customer_search;

import static dev.typr.foundations.Fragment.interpolate;

import dev.typr.foundations.Fragment;
import dev.typr.foundations.OracleTypes;
import java.sql.Connection;
import java.util.List;

public class CustomerSearchSqlRepoImpl implements CustomerSearchSqlRepo {
  @Override
  public List<CustomerSearchSqlRow> apply(String namePattern, Connection c) {
    return interpolate(
            Fragment.lit(
                "-- Search customers by name pattern\n"
                    + "SELECT\n"
                    + "    c.customer_id,\n"
                    + "    c.name,\n"
                    + "    c.billing_address,\n"
                    + "    c.credit_limit,\n"
                    + "    c.created_at\n"
                    + "FROM customers c\n"
                    + "WHERE c.name LIKE "),
            Fragment.encode(OracleTypes.varchar2, namePattern),
            Fragment.lit("\nORDER BY c.name\n"))
        .query(CustomerSearchSqlRow._rowParser.all())
        .runUnchecked(c);
  }
}
