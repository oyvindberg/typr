/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.product_summary

import dev.typr.foundations.kotlin.Fragment
import java.sql.Connection
import kotlin.collections.List

class ProductSummarySqlRepoImpl() : ProductSummarySqlRepo {
  override fun apply(c: Connection): List<ProductSummarySqlRow> = Fragment.interpolate(Fragment.lit("-- Product Summary View\n-- Shows product details with aggregated information\n-- This tests DuckDB SQL file processing and view generation\n\nSELECT\n  p.product_id,\n  p.name as product_name,\n  p.sku,\n  p.price,\n  COUNT(*) as order_count,\n  COALESCE(SUM(oi.quantity), 0) as total_quantity,\n  COALESCE(SUM(oi.quantity * oi.unit_price), 0) as total_revenue\nFROM products p\nLEFT JOIN order_items oi ON p.product_id = oi.product_id\nGROUP BY p.product_id, p.name, p.sku, p.price\n")).query(ProductSummarySqlRow._rowParser.all()).runUnchecked(c)
}