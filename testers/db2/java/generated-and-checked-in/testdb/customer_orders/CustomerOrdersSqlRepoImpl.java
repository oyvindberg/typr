/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.customer_orders;

import static dev.typr.foundations.Fragment.interpolate;

import dev.typr.foundations.Db2Types;
import dev.typr.foundations.Fragment;
import java.sql.Connection;
import java.util.List;

public class CustomerOrdersSqlRepoImpl implements CustomerOrdersSqlRepo {
  @Override
  public List<CustomerOrdersSqlRow> apply(Integer customerId, Connection c) {
    return interpolate(
            Fragment.lit(
                "-- Get customer order details\n"
                    + "SELECT\n"
                    + "    c.customer_id,\n"
                    + "    c.name as customer_name,\n"
                    + "    o.order_id,\n"
                    + "    o.order_date,\n"
                    + "    o.total_amount,\n"
                    + "    o.status\n"
                    + "FROM customers c\n"
                    + "INNER JOIN orders o ON c.customer_id = o.customer_id\n"
                    + "WHERE c.customer_id = "),
            Fragment.encode(Db2Types.integer, customerId),
            Fragment.lit("\nORDER BY o.order_date DESC\n"))
        .query(CustomerOrdersSqlRow._rowParser.all())
        .runUnchecked(c);
  }
  ;
}
