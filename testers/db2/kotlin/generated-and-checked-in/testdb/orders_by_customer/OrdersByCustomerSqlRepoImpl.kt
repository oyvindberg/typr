/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.orders_by_customer

import dev.typr.foundations.kotlin.Fragment
import dev.typr.foundations.kotlin.KotlinDbTypes
import java.sql.Connection
import kotlin.collections.List

class OrdersByCustomerSqlRepoImpl() : OrdersByCustomerSqlRepo {
  override fun apply(
    customerId: Int,
    c: Connection
  ): List<OrdersByCustomerSqlRow> = Fragment.interpolate(Fragment.lit("-- Orders by customer with order items\nSELECT o.order_id, o.order_date, o.total_amount, o.status,\n       i.item_number, i.product_name, i.quantity, i.unit_price\nFROM orders o\nINNER JOIN order_items i ON o.order_id = i.order_id\nWHERE o.customer_id = "), Fragment.encode(KotlinDbTypes.Db2Types.integer, customerId), Fragment.lit("\nORDER BY o.order_date DESC, i.item_number\n")).query(OrdersByCustomerSqlRow._rowParser.all()).runUnchecked(c)
}