/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.customer_summary

import dev.typr.foundations.kotlin.Fragment
import java.sql.Connection
import kotlin.collections.List

class CustomerSummarySqlRepoImpl() : CustomerSummarySqlRepo {
  override fun apply(c: Connection): List<CustomerSummarySqlRow> = Fragment.interpolate(Fragment.lit("-- Customer summary with total orders\nSELECT c.customer_id, c.name, c.email,\n       COUNT(o.order_id) as order_count,\n       COALESCE(SUM(o.total_amount), 0) as total_spent\nFROM customers c\nLEFT JOIN orders o ON c.customer_id = o.customer_id\nGROUP BY c.customer_id, c.name, c.email\n")).query(CustomerSummarySqlRow._rowParser.all()).runUnchecked(c)
}