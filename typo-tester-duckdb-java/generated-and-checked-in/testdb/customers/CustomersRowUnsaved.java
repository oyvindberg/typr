/**
 * File has been automatically generated by `typo`.
 *
 * <p>IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.customers;

import com.fasterxml.jackson.annotation.JsonProperty;
import java.time.LocalDateTime;
import java.util.Optional;
import testdb.Priority;
import testdb.customtypes.Defaulted;
import testdb.customtypes.Defaulted.UseDefault;
import typo.runtime.DuckDbText;
import typo.runtime.DuckDbTypes;

/** This class corresponds to a row in table `customers` which has not been persisted yet */
public record CustomersRowUnsaved(
    @JsonProperty("customer_id") CustomersId customerId,
    String name,
    Optional<String> email,
    /** Default: current_timestamp */
    @JsonProperty("created_at") Defaulted<LocalDateTime> createdAt,
    /** Default: 'medium' */
    Defaulted<Optional<Priority>> priority) {
  public CustomersRowUnsaved(@JsonProperty("customer_id") CustomersId customerId, String name) {
    this(customerId, name, Optional.empty(), new UseDefault<>(), new UseDefault<>());
  }
  ;

  public CustomersRowUnsaved withCustomerId(CustomersId customerId) {
    return new CustomersRowUnsaved(customerId, name, email, createdAt, priority);
  }
  ;

  public CustomersRowUnsaved withName(String name) {
    return new CustomersRowUnsaved(customerId, name, email, createdAt, priority);
  }
  ;

  public CustomersRowUnsaved withEmail(Optional<String> email) {
    return new CustomersRowUnsaved(customerId, name, email, createdAt, priority);
  }
  ;

  /** Default: current_timestamp */
  public CustomersRowUnsaved withCreatedAt(Defaulted<LocalDateTime> createdAt) {
    return new CustomersRowUnsaved(customerId, name, email, createdAt, priority);
  }
  ;

  /** Default: 'medium' */
  public CustomersRowUnsaved withPriority(Defaulted<Optional<Priority>> priority) {
    return new CustomersRowUnsaved(customerId, name, email, createdAt, priority);
  }
  ;

  public static DuckDbText<CustomersRowUnsaved> duckDbText =
      DuckDbText.instance(
          (row, sb) -> {
            CustomersId.duckDbType.duckDbText().unsafeEncode(row.customerId, sb);
            sb.append(DuckDbText.DELIMETER);
            DuckDbTypes.varchar.duckDbText().unsafeEncode(row.name, sb);
            sb.append(DuckDbText.DELIMETER);
            DuckDbTypes.varchar.opt().duckDbText().unsafeEncode(row.email, sb);
            sb.append(DuckDbText.DELIMETER);
            Defaulted.duckDbText(DuckDbTypes.timestamp.duckDbText())
                .unsafeEncode(row.createdAt, sb);
            sb.append(DuckDbText.DELIMETER);
            Defaulted.duckDbText(Priority.duckDbType.opt().duckDbText())
                .unsafeEncode(row.priority, sb);
          });

  public CustomersRow toRow(
      java.util.function.Supplier<LocalDateTime> createdAtDefault,
      java.util.function.Supplier<Optional<Priority>> priorityDefault) {
    return new CustomersRow(
        customerId,
        name,
        email,
        createdAt.getOrElse(createdAtDefault),
        priority.getOrElse(priorityDefault));
  }
  ;
}
