/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package testdb.product_prices

import com.fasterxml.jackson.annotation.JsonProperty
import java.math.BigDecimal
import java.time.LocalDate
import testdb.customtypes.Defaulted
import testdb.customtypes.Defaulted.UseDefault
import testdb.price_tiers.PriceTiersId
import testdb.products.ProductsId
import typo.kotlindsl.KotlinDbTypes
import typo.kotlindsl.nullable
import typo.runtime.MariaText
import typo.runtime.MariaTypes

/** This class corresponds to a row in table `product_prices` which has not been persisted yet */
data class ProductPricesRowUnsaved(
  /** 
    * Points to [testdb.products.ProductsRow.productId]
    */
  @JsonProperty("product_id") val productId: ProductsId,
  /**  */
  val price: BigDecimal,
  /**  */
  @JsonProperty("valid_from") val validFrom: LocalDate,
  /** Default: NULL
    * Points to [testdb.price_tiers.PriceTiersRow.tierId]
    */
  @JsonProperty("tier_id") val tierId: Defaulted<PriceTiersId?> = UseDefault(),
  /** Default: 'USD'

    */
  @JsonProperty("currency_code") val currencyCode: Defaulted<String> = UseDefault(),
  /** Default: NULL

    */
  @JsonProperty("valid_to") val validTo: Defaulted<LocalDate?> = UseDefault()
) {
  fun toRow(
    tierIdDefault: () -> PriceTiersId?,
    currencyCodeDefault: () -> String,
    validToDefault: () -> LocalDate?,
    priceIdDefault: () -> ProductPricesId
  ): ProductPricesRow = ProductPricesRow(priceId = priceIdDefault(), productId = productId, tierId = tierId.getOrElse(tierIdDefault), price = price, currencyCode = currencyCode.getOrElse(currencyCodeDefault), validFrom = validFrom, validTo = validTo.getOrElse(validToDefault))

  companion object {
    val mariaText: MariaText<ProductPricesRowUnsaved> =
      MariaText.instance({ row, sb -> ProductsId.pgType.mariaText().unsafeEncode(row.productId, sb)
      sb.append(MariaText.DELIMETER)
      KotlinDbTypes.MariaTypes.numeric.mariaText().unsafeEncode(row.price, sb)
      sb.append(MariaText.DELIMETER)
      MariaTypes.date.mariaText().unsafeEncode(row.validFrom, sb)
      sb.append(MariaText.DELIMETER)
      Defaulted.mariaText(PriceTiersId.pgType.nullable().mariaText()).unsafeEncode(row.tierId, sb)
      sb.append(MariaText.DELIMETER)
      Defaulted.mariaText(MariaTypes.char_.mariaText()).unsafeEncode(row.currencyCode, sb)
      sb.append(MariaText.DELIMETER)
      Defaulted.mariaText(MariaTypes.date.nullable().mariaText()).unsafeEncode(row.validTo, sb) })
  }
}