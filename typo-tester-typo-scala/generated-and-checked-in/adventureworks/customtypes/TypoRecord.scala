/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package adventureworks.customtypes

import org.postgresql.util.PGobject
import typo.dsl.Bijection
import typo.runtime.PgRead
import typo.runtime.PgText
import typo.runtime.PgType
import typo.runtime.PgWrite

/** record (via PGObject) */
case class TypoRecord(value: String)

object TypoRecord {
  given bijection: Bijection[TypoRecord, String] = Bijection.apply[TypoRecord, String](_.value)(TypoRecord.apply)

  given pgText: PgText[TypoRecord] = PgText.textString.contramap(v => v.value)

  given pgType: PgType[TypoRecord] = {
    PgType.of(
      "record",
      PgRead.castJdbcObjectTo(classOf[PGobject]).map(v => new TypoRecord(v.getValue)),
      PgWrite.passObjectToJdbc().contramap((v: TypoRecord) => {
                                             val obj = new PGobject()
                                             obj.setType("record")
                                             obj.setValue(v.value)
                                             obj
                                           }),
      TypoRecord.pgText
    )
  }

  given pgTypeArray: PgType[Array[TypoRecord]] = {
    TypoRecord.pgType.array(PgRead.castJdbcArrayTo(classOf[PGobject]).map(xs => xs.map(v => new TypoRecord(v.getValue))), PgWrite.passObjectToJdbc[PGobject]().array(TypoRecord.pgType.typename().as[PGobject]()).contramap(xs => xs.map((v: TypoRecord) => {
      val obj = new PGobject()
      obj.setType("record")
      obj.setValue(v.value)
      obj
    })))
  }
}