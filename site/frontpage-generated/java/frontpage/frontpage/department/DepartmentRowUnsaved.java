/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package frontpage.frontpage.department;

import com.fasterxml.jackson.annotation.JsonProperty;
import frontpage.customtypes.Defaulted;
import frontpage.customtypes.Defaulted.UseDefault;
import frontpage.frontpage.company.CompanyId;
import java.math.BigDecimal;
import java.util.Optional;
import typo.runtime.PgText;
import typo.runtime.PgTypes;

/** This class corresponds to a row in table `frontpage.department` which has not been persisted yet */
public record DepartmentRowUnsaved(
  String name,
  Optional<BigDecimal> budget,
  /** Points to {@link frontpage.frontpage.company.CompanyRow#id()} */
  @JsonProperty("company_id") Optional<CompanyId> companyId,
  /** Default: gen_random_uuid() */
  Defaulted<DepartmentId> id
) {
  public DepartmentRowUnsaved(String name) {
    this(name, Optional.empty(), Optional.empty(), new UseDefault<>());
  };

  public DepartmentRowUnsaved withName(String name) {
    return new DepartmentRowUnsaved(name, budget, companyId, id);
  };

  public DepartmentRowUnsaved withBudget(Optional<BigDecimal> budget) {
    return new DepartmentRowUnsaved(name, budget, companyId, id);
  };

  /** Points to {@link frontpage.frontpage.company.CompanyRow#id()} */
  public DepartmentRowUnsaved withCompanyId(Optional<CompanyId> companyId) {
    return new DepartmentRowUnsaved(name, budget, companyId, id);
  };

  /** Default: gen_random_uuid() */
  public DepartmentRowUnsaved withId(Defaulted<DepartmentId> id) {
    return new DepartmentRowUnsaved(name, budget, companyId, id);
  };

  static public PgText<DepartmentRowUnsaved> pgText =
    PgText.instance((row, sb) -> {
      PgTypes.text.pgText().unsafeEncode(row.name, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.numeric.opt().pgText().unsafeEncode(row.budget, sb);
      sb.append(PgText.DELIMETER);
      CompanyId.pgType.opt().pgText().unsafeEncode(row.companyId, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(DepartmentId.pgType.pgText()).unsafeEncode(row.id, sb);
    });

  public DepartmentRow toRow(java.util.function.Supplier<DepartmentId> idDefault) {
    return new DepartmentRow(id.getOrElse(idDefault), name, budget, companyId);
  };
}