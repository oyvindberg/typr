/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package frontpage.frontpage.order_item;

import com.fasterxml.jackson.annotation.JsonProperty;
import frontpage.customtypes.Defaulted;
import frontpage.customtypes.Defaulted.UseDefault;
import frontpage.customtypes.TypoLocalDateTime;
import frontpage.frontpage.order.OrderId;
import frontpage.frontpage.product.ProductId;
import java.math.BigDecimal;
import java.util.Optional;
import typo.runtime.PgText;
import typo.runtime.PgTypes;

/** This class corresponds to a row in table `frontpage.order_item` which has not been persisted yet */
public record OrderItemRowUnsaved(
  /** Points to {@link frontpage.frontpage.order.OrderRow#id()} */
  @JsonProperty("order_id") Optional<OrderId> orderId,
  /** Points to {@link frontpage.frontpage.product.ProductRow#id()} */
  @JsonProperty("product_id") Optional<ProductId> productId,
  Integer quantity,
  BigDecimal price,
  @JsonProperty("shipped_at") Optional<TypoLocalDateTime> shippedAt,
  /** Default: gen_random_uuid() */
  Defaulted<OrderItemId> id
) {
  public OrderItemRowUnsaved(
    Integer quantity,
    BigDecimal price
  ) {
    this(Optional.empty(), Optional.empty(), quantity, price, Optional.empty(), new UseDefault<>());
  };

  /** Points to {@link frontpage.frontpage.order.OrderRow#id()} */
  public OrderItemRowUnsaved withOrderId(Optional<OrderId> orderId) {
    return new OrderItemRowUnsaved(orderId, productId, quantity, price, shippedAt, id);
  };

  /** Points to {@link frontpage.frontpage.product.ProductRow#id()} */
  public OrderItemRowUnsaved withProductId(Optional<ProductId> productId) {
    return new OrderItemRowUnsaved(orderId, productId, quantity, price, shippedAt, id);
  };

  public OrderItemRowUnsaved withQuantity(Integer quantity) {
    return new OrderItemRowUnsaved(orderId, productId, quantity, price, shippedAt, id);
  };

  public OrderItemRowUnsaved withPrice(BigDecimal price) {
    return new OrderItemRowUnsaved(orderId, productId, quantity, price, shippedAt, id);
  };

  public OrderItemRowUnsaved withShippedAt(Optional<TypoLocalDateTime> shippedAt) {
    return new OrderItemRowUnsaved(orderId, productId, quantity, price, shippedAt, id);
  };

  /** Default: gen_random_uuid() */
  public OrderItemRowUnsaved withId(Defaulted<OrderItemId> id) {
    return new OrderItemRowUnsaved(orderId, productId, quantity, price, shippedAt, id);
  };

  static public PgText<OrderItemRowUnsaved> pgText =
    PgText.instance((row, sb) -> {
      OrderId.pgType.opt().pgText().unsafeEncode(row.orderId, sb);
      sb.append(PgText.DELIMETER);
      ProductId.pgType.opt().pgText().unsafeEncode(row.productId, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.int4.pgText().unsafeEncode(row.quantity, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.numeric.pgText().unsafeEncode(row.price, sb);
      sb.append(PgText.DELIMETER);
      TypoLocalDateTime.pgType.opt().pgText().unsafeEncode(row.shippedAt, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(OrderItemId.pgType.pgText()).unsafeEncode(row.id, sb);
    });

  public OrderItemRow toRow(java.util.function.Supplier<OrderItemId> idDefault) {
    return new OrderItemRow(id.getOrElse(idDefault), orderId, productId, quantity, price, shippedAt);
  };
}