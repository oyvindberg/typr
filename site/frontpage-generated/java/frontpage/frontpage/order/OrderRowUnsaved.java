/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package frontpage.frontpage.order;

import com.fasterxml.jackson.annotation.JsonProperty;
import frontpage.customtypes.Defaulted;
import frontpage.customtypes.Defaulted.UseDefault;
import frontpage.customtypes.TypoLocalDateTime;
import frontpage.frontpage.OrderStatus;
import frontpage.frontpage.product.ProductId;
import frontpage.frontpage.user.UserId;
import java.math.BigDecimal;
import java.util.Optional;
import typo.runtime.PgText;
import typo.runtime.PgTypes;

/** This class corresponds to a row in table `frontpage.order` which has not been persisted yet */
public record OrderRowUnsaved(
  /** Points to {@link frontpage.frontpage.user.UserRow#id()} */
  @JsonProperty("user_id") Optional<UserId> userId,
  /** Points to {@link frontpage.frontpage.product.ProductRow#id()} */
  @JsonProperty("product_id") Optional<ProductId> productId,
  BigDecimal total,
  @JsonProperty("shipped_at") Optional<TypoLocalDateTime> shippedAt,
  /** Default: gen_random_uuid() */
  Defaulted<OrderId> id,
  /** Default: 'pending'::frontpage.order_status */
  Defaulted<Optional<OrderStatus>> status,
  /** Default: now() */
  @JsonProperty("created_at") Defaulted<Optional<TypoLocalDateTime>> createdAt
) {
  public OrderRowUnsaved(BigDecimal total) {
    this(Optional.empty(), Optional.empty(), total, Optional.empty(), new UseDefault<>(), new UseDefault<>(), new UseDefault<>());
  };

  /** Points to {@link frontpage.frontpage.user.UserRow#id()} */
  public OrderRowUnsaved withUserId(Optional<UserId> userId) {
    return new OrderRowUnsaved(userId, productId, total, shippedAt, id, status, createdAt);
  };

  /** Points to {@link frontpage.frontpage.product.ProductRow#id()} */
  public OrderRowUnsaved withProductId(Optional<ProductId> productId) {
    return new OrderRowUnsaved(userId, productId, total, shippedAt, id, status, createdAt);
  };

  public OrderRowUnsaved withTotal(BigDecimal total) {
    return new OrderRowUnsaved(userId, productId, total, shippedAt, id, status, createdAt);
  };

  public OrderRowUnsaved withShippedAt(Optional<TypoLocalDateTime> shippedAt) {
    return new OrderRowUnsaved(userId, productId, total, shippedAt, id, status, createdAt);
  };

  /** Default: gen_random_uuid() */
  public OrderRowUnsaved withId(Defaulted<OrderId> id) {
    return new OrderRowUnsaved(userId, productId, total, shippedAt, id, status, createdAt);
  };

  /** Default: 'pending'::frontpage.order_status */
  public OrderRowUnsaved withStatus(Defaulted<Optional<OrderStatus>> status) {
    return new OrderRowUnsaved(userId, productId, total, shippedAt, id, status, createdAt);
  };

  /** Default: now() */
  public OrderRowUnsaved withCreatedAt(Defaulted<Optional<TypoLocalDateTime>> createdAt) {
    return new OrderRowUnsaved(userId, productId, total, shippedAt, id, status, createdAt);
  };

  static public PgText<OrderRowUnsaved> pgText =
    PgText.instance((row, sb) -> {
      UserId.pgType.opt().pgText().unsafeEncode(row.userId, sb);
      sb.append(PgText.DELIMETER);
      ProductId.pgType.opt().pgText().unsafeEncode(row.productId, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.numeric.pgText().unsafeEncode(row.total, sb);
      sb.append(PgText.DELIMETER);
      TypoLocalDateTime.pgType.opt().pgText().unsafeEncode(row.shippedAt, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(OrderId.pgType.pgText()).unsafeEncode(row.id, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(OrderStatus.pgType.opt().pgText()).unsafeEncode(row.status, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(TypoLocalDateTime.pgType.opt().pgText()).unsafeEncode(row.createdAt, sb);
    });

  public OrderRow toRow(
    java.util.function.Supplier<OrderId> idDefault,
    java.util.function.Supplier<Optional<OrderStatus>> statusDefault,
    java.util.function.Supplier<Optional<TypoLocalDateTime>> createdAtDefault
  ) {
    return new OrderRow(id.getOrElse(idDefault), userId, productId, status.getOrElse(statusDefault), total, createdAt.getOrElse(createdAtDefault), shippedAt);
  };
}