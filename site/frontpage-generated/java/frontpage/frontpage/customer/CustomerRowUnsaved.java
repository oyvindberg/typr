/**
 * File has been automatically generated by `typo`.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN.
 */
package frontpage.frontpage.customer;

import com.fasterxml.jackson.annotation.JsonProperty;
import frontpage.customtypes.Defaulted;
import frontpage.customtypes.Defaulted.UseDefault;
import frontpage.frontpage.user.UserId;
import java.math.BigDecimal;
import java.util.Optional;
import typo.runtime.PgText;
import typo.runtime.PgTypes;

/** This class corresponds to a row in table `frontpage.customer` which has not been persisted yet */
public record CustomerRowUnsaved(
  /** Points to {@link frontpage.frontpage.user.UserRow#id()} */
  @JsonProperty("user_id") Optional<UserId> userId,
  @JsonProperty("company_name") Optional<String> companyName,
  @JsonProperty("credit_limit") Optional<BigDecimal> creditLimit,
  /** Default: gen_random_uuid() */
  Defaulted<CustomerId> id,
  /** Default: false */
  Defaulted<Optional<Boolean>> verified
) {
  public CustomerRowUnsaved() {
    this(Optional.empty(), Optional.empty(), Optional.empty(), new UseDefault<>(), new UseDefault<>());
  };

  /** Points to {@link frontpage.frontpage.user.UserRow#id()} */
  public CustomerRowUnsaved withUserId(Optional<UserId> userId) {
    return new CustomerRowUnsaved(userId, companyName, creditLimit, id, verified);
  };

  public CustomerRowUnsaved withCompanyName(Optional<String> companyName) {
    return new CustomerRowUnsaved(userId, companyName, creditLimit, id, verified);
  };

  public CustomerRowUnsaved withCreditLimit(Optional<BigDecimal> creditLimit) {
    return new CustomerRowUnsaved(userId, companyName, creditLimit, id, verified);
  };

  /** Default: gen_random_uuid() */
  public CustomerRowUnsaved withId(Defaulted<CustomerId> id) {
    return new CustomerRowUnsaved(userId, companyName, creditLimit, id, verified);
  };

  /** Default: false */
  public CustomerRowUnsaved withVerified(Defaulted<Optional<Boolean>> verified) {
    return new CustomerRowUnsaved(userId, companyName, creditLimit, id, verified);
  };

  static public PgText<CustomerRowUnsaved> pgText =
    PgText.instance((row, sb) -> {
      UserId.pgType.opt().pgText().unsafeEncode(row.userId, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.text.opt().pgText().unsafeEncode(row.companyName, sb);
      sb.append(PgText.DELIMETER);
      PgTypes.numeric.opt().pgText().unsafeEncode(row.creditLimit, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(CustomerId.pgType.pgText()).unsafeEncode(row.id, sb);
      sb.append(PgText.DELIMETER);
      Defaulted.pgText(PgTypes.bool.opt().pgText()).unsafeEncode(row.verified, sb);
    });

  public CustomerRow toRow(
    java.util.function.Supplier<CustomerId> idDefault,
    java.util.function.Supplier<Optional<Boolean>> verifiedDefault
  ) {
    return new CustomerRow(id.getOrElse(idDefault), userId, companyName, creditLimit, verified.getOrElse(verifiedDefault));
  };
}